"use strict";!function(){var i=$(document),t=getUrlPar("id"),n=juicer($("#list-tpl").html()),e=!1,o=1,c=!1;function r(i){c||(showLoad(),c=!0,i&&(o=1,e=!1),goAPI({url:_api.comment_list,data:{id:t,pageNo:o},success:function(t){t=t.data,i&&$("#list-box").empty(),0==t.total?e=!0:(o+=1,$("#list-box").append(n.render(t)),t.hasNextPage||(e=!0)),_config.is_wx&&!_config.wx_config&&configWXJSSDK(["previewImage"].concat(_config.wx_share),{success:function(){}})},error:function(t){i?showConfirm({str:t,btn_yes:{str:"重新加载",event_click:function(){r(i)}}}):showConfirm({str:t})},complete:function(){hideLoad(),c=!1}}))}t?function n(){showLoad();goAPI({url:_api.shop_detail,data:{id:t},success:function(t){t=t.data,$(".container").html(juicer($("#main-tpl").html(),t));var n=t.img.split("_"),o=$.map(n,function(i,t){return/null\?/.test(i)?"http://www.chevhuzhu.com/hfive/img/default_shop_2.png":i});if((n=$.map(n,function(i,t){return{src:i,default:"/hfive/img/default_shop_2.png"}})).length>0){var s=preview({background:"#000",fill:"fix",point:!0,number:!0,imgs:n}),a=preview({fixed:!1,auto:!0,dely:3e3,height:"100%",point:!0,container:$("#img-box"),imgs:n,event_click:function(i){if(_config.is_wx){if(_config.wx_config){var t=[];$("#img-box .preview-img img").each(function(){t.push($(this).attr("src"))}),t.length>2&&(t=t.slice(1,t.length-2)),wx.previewImage({current:o[i],urls:o})}}else s.show({index:i})}});a.show()}$window.on("scroll",function(){c||e||$window.height()+$window.scrollTop()+30<i.height()||r()}),r(!0)},error:function(i){showConfirm({str:i,btn_yes:{str:"重新加载",event_click:n}})},complete:function(){hideLoad()}})}():showConfirm({str:"缺少商家id",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}})}();