"use strict";!function(){var e,t,s=checkLogin(),o=juicer($("#main-tpl").html()),n=0,i=getUrlPar("fromid"),a=getUrlPar("sid"),r={};i&&saveStorage("from_id",i,!0);function c(){showLoad(),goAPI({url:_api.index,data:{token:s?s.token:""},success:function(s){if(s=s.data,$.isArray(s.carList)&&s.carList.length>0)if(0,e={num:s.carList.length},1===s.carList.length)e.car=s.carList[0];else{for(var a=!1,l=0,h=s.carList.length;l<h;l++)if(20==s.carList[l].status){a=!0;break}e.all_clear=a}else e={num:0};s.btn_join=e,$(".container").html(o.render(s)),n=$("#showbox").offset().top,r&&r.name&&$(".btn-join").html('<p class="p2 fbox-ac fbox-f1"><span class="fbox-f1">恭喜您！获得由'+r.name+'送出的1000元擦刮维修补贴</span><span>　去领取</span><span class="arr3 arr-white arr-right" style="margin-left:.1rem;"></span></p>').attr("href","/hfive/view/car_add.html"),$(".intro-list2").on("click",".intro-btn",function(){$(this).closest(".intro-item").toggleClass("active")}),$(".show-menu").on("click","a",function(){var e=$(this).index();$(".show-menu").each(function(t,s){$(s).find("a").removeClass("active").eq(e).addClass("active")}),$("#show-content .show-item").eq(e).removeClass("hide").siblings(".show-item").addClass("hide"),setTimeout(function(){t.scrollTo(0,n)},50),$(".navbar-bottom").addClass("close"),$(".btn-join.join-top").removeClass("active"),$(".btn-join.join-bottom").addClass("active")}),$("#show-content").on("swipeLeft",function(){var e=$(".show-menu.show-top a.active").index();e<2&&$(".show-menu.show-top a").eq(e+1).click()}).on("swipeRight",function(){var e=$(".show-menu.show-top a.active").index();e>0&&$(".show-menu.show-top a").eq(e-1).click()}),t=tabbox({container:".tabbox",height:"100%",pull:!0,exception_class:".no-scroll",event_pullMove:function(e,t){e>=40?($(".tabbox-refresh .txt").text("松开刷新"),$(".tabbox-refresh .arr3").addClass("uturn")):($(".tabbox-refresh .txt").text("下拉刷新"),$(".tabbox-refresh .arr3").removeClass("uturn"))},event_pullEnd:function(e,t){e>=40&&($(".tabbox-refresh .txt").text("下拉刷新"),$(".tabbox-refresh .arr3").removeClass("uturn"),c())},event_scroll:function(e,t,s){t>=n?($(".show-menu.show-main").addClass("close"),$(".show-menu.show-top").removeClass("close")):($(".show-menu.show-main").removeClass("close"),$(".show-menu.show-top").addClass("close")),-1===s?($(".navbar-bottom").addClass("close"),$(".btn-join.join-top").removeClass("active"),$(".btn-join.join-bottom").addClass("active")):1===s&&t<n&&($(".navbar-bottom").removeClass("close"),$(".btn-join.join-top").addClass("active"),$(".btn-join.join-bottom").removeClass("active"))}}),function(){var e=$("#scroll-panel"),t=e.closest(".intro-fbox").siblings(".intro-desc"),s=(e.find(".intro-item").length,!1),o=4,n=0,i=0;function a(s){(i=s-n)<0||i>o-1?i<0?i=0:i>o-1&&(i=o-1):(t.removeClass("s1 s2 s3 s4").addClass("s"+(i+1)).find("p").removeClass("show").filter(".p"+(n+i+1)).addClass("show"),e.find(".intro-item").removeClass("active").eq(n+i).addClass("active"))}$("#scroll-box").on("swipeLeft",function(){a(i+1)}).on("swipeRight",function(){a(i-1)}),e.on("click",".intro-item",function(){var e=$(this);e.hasClass("active")||s||a(e.index())})}(),_config.is_wx&&(_config.wx_config||configWXJSSDK(_config.wx_share,{success:function(){shareWX({title:_share_title,desc:_share_desc,link:_share_link})}}),checkFollow({success:function(e){1==e.data?$(".btn-join").off("click"):($(".btn-join").off("click").on("click",function(e){e.preventDefault(),showConfirm({str:"扫码认识我",cover_close:!0,node:'<img src="/hfive/img/chevhuzhu_qr_s.jpg" style="width:3rem;height:3rem;">',btn_close:!0,btn_yes:{str:null}})}),i&&showConfirm({str:"关注公众号<br>我们一起领取500元额度",cover_close:!0,node:'<img src="/hfive/img/chevhuzhu_qr_s.jpg" style="width:3rem;height:3rem;">',btn_close:!0,btn_yes:{str:null}}))}}))},error:function(e){showConfirm({str:e,btn_yes:{str:"重新加载",event_click:c}})},complete:function(){hideLoad()}})}function l(e){a?goAPI({url:_api.shop_detail_simple,data:{shopId:a},success:function(t){(t=t.data)&&(r=t),$.isFunction(e)&&e()},error:function(t){hideLoad(),showConfirm({str:t,btn_yes:{str:"重新加载",event_click:function(){l(e)}}})}}):$.isFunction(e)&&e()}juicer.register("build_btime",function(){var e=new Date("2018","3","4"),t=(new Date).getTime()-e.getTime();return t<=0?"1":Math.ceil(t/864e5)}),_config.is_wx?wxOauth(function(){l(c)}):l(c)}();