"use strict";var user_data,loading=!1,user=checkLogin(!0),share_url="",avatar_loaded=!1,qrcode_loaded=!1;function loadData(){showLoad(),loading=!0,goAPI({url:_api.user,data:{token:user.token},success:function(e){user_data=e.data,goAPI({url:_api.user_other,data:{customerId:user_data.id},success:function(e){loading=!1;var a=e.data;share_url="http://www.chevhuzhu.com/hfive/view/event_join2.html?id="+user_data.id,_config.is_wx&&configWXJSSDK(_config.wx_share,{success:function(){shareWX({imgUrl:"http://www.chevhuzhu.com/hfive/img/icon_ca.png",title:user_data.userName+"邀请你免费领取1000元擦挂补贴",desc:"小擦刮还在报保险？这样处理省一大笔",link:share_url})}}),a.qrcode||(qrcode_loaded=!0),$("#container").html(juicer($("#main-tpl").html(),a)),$("#btn-rule").on("click",function(){showConfirm({class:"tl",title:"会员特权",str:"分享海报邀请朋友扫码免费领取1000元擦挂维修金，并关注公号添加车牌；平台自动为Ta充值基础互助金，30天观察期后可开始限时体验擦挂维修。\n\n福利一：\n邀请好友，好友免费领取1000元擦刮维修金;\n\n福利二：\n邀请满2名好友即可获得1元购买洗车活动(限购2次)；\n\n福利三：\n每邀请一位好友加入，自己的擦刮额度就提升125元最多增额500提升至1500元；\n\n福利四：\n每邀请一位好友加入，平台即为你的账户余额充值3元互助金（用于分摊）。",cover_close:!0})})},error:function(e){loading=!1,hideLoad(),showConfirm({str:e,btn_yes:{str:"重新加载",event_click:loadData}})}})},error:function(e){hideLoad(),loading=!1,showConfirm({str:e,btn_yes:{str:"重新加载",event_click:loadData}})}})}function showAvatar(e){resetImg(e),avatar_loaded=!0,showImg()}function showQrcode(){qrcode_loaded=!0,showImg()}function showImg(){avatar_loaded&&qrcode_loaded&&createImg(function(){$("#text1").addClass("hide"),$("#qr").addClass("hide"),$("#source").addClass("upper"),$("#container").addClass("red"),hideLoad()})}function createImg(e){setTimeout(function(){$("#main").height($("#main").height()),$("#source").height($("#main").height()),$(".avatar img").removeAttr("onload"),$("#qr img").removeAttr("onload");var a=$("#main"),t=a.width(),o=a.height(),n=document.createElement("canvas"),r=a.get(0).getBoundingClientRect();n.width=1*t,n.height=1*o,n.style.width=1*t+"px",n.style.height=1*o+"px";var i=n.getContext("2d");i.scale(1,1),i.translate(-r.left,-r.top-$("#container").scrollTop()),html2canvas(a[0],{canvas:n,useCORS:!0,onrendered:function(a){$("#source").append($("<img>",{class:"view",src:a.toDataURL("image/png")})),$("#source .view").length>1&&$("#source .view:eq(0)").remove(),$.isFunction(e)&&e()}})},300)}user&&loadData();