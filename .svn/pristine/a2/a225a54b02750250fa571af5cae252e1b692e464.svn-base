"use strict";var user_data,loading=!1,user=checkLogin(!0),share_url="",money_base=1e3,money_max=1500,money_reward=125;function loadData(){showLoad(),loading=!0,goAPI({url:_api.user,data:{token:user.token},success:function(e){user_data=e.data,goAPI({url:_api.user_other,data:{customerId:user_data.id},success:function(e){loading=!1;var a=e.data;share_url="http://www.chevhuzhu.com/hfive/view/event_join2.html?id="+user_data.id,_config.is_wx&&configWXJSSDK(_config.wx_share,{success:function(){shareWX({title:user_data.userName+"邀你免费领取1000元小擦刮维修补贴金",desc:user_data.userName+"邀你免费领取1000元小擦刮维修补贴金",link:share_url})}}),$("#container").html(juicer($("#main-tpl").html(),a)),$("#btn-rule").on("click",function(){showConfirm({class:"tl",title:"会员特权",str:"分享海报邀请朋友扫码免费领取"+money_base+"元擦挂维修金，并关注公号添加车牌；平台自动为Ta充值基础互助金，30天观察期后可开始限时体验擦挂维修。\n\n福利一：\n每邀请一位朋友加入，自己的维修额度提升"+money_reward+"元，最多增加"+4*money_reward+"提升至"+(money_base+4*money_reward)+"元；\n\n福利二：\n每邀请一位朋友加入，平台为你自己的账户充值3元互助金。",cover_close:!0})})},error:function(e){loading=!1,hideLoad(),showConfirm({str:e,btn_yes:{str:"重新加载",event_click:loadData}})}})},error:function(e){hideLoad(),loading=!1,showConfirm({str:e,btn_yes:{str:"重新加载",event_click:loadData}})}})}function showImg(e){resetImg(e),createImg(function(){$("#text1").addClass("hide"),$("#qr").addClass("hide"),$("#source").addClass("upper"),$("#container").addClass("red"),hideLoad()})}function createImg(e){new QRCode($("#qr")[0],{text:share_url,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),setTimeout(function(){$("#main").height($("#main").height()),$("#source").height($("#main").height()),$(".avatar img").removeAttr("onload");var a=$("#main"),t=a.width(),n=a.height(),r=document.createElement("canvas"),o=a.get(0).getBoundingClientRect();r.width=1*t,r.height=1*n,r.style.width=1*t+"px",r.style.height=1*n+"px";var s=r.getContext("2d");s.scale(1,1),s.translate(-o.left,-o.top-$("#container").scrollTop()),html2canvas(a[0],{canvas:r,useCORS:!0,onrendered:function(a){$("#source").append($("<img>",{class:"view",src:a.toDataURL("image/png")})),$("#source .view").length>1&&$("#source .view:eq(0)").remove(),$.isFunction(e)&&e()}})},300)}user&&loadData();