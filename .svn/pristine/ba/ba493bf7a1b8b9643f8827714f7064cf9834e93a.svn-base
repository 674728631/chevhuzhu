"use strict";!function(){var t,e=!1,n=getUrlPar("id"),o=checkLogin(!0),s=0;o&&(n?function i(){showLoad();goAPI({url:_api.order_detail,data:{token:o.token,eventNo:n},success:function(n){71==(t=n.data).statusEvent?($(".container").html(juicer($("#main-tpl").html(),t)),$("#star-box").on("click",".i-star",function(){var t=$(this).removeClass("empty"),e=t.siblings(".i-star");s=t.index(),$("#star").text(s),e.each(function(t){t<s-1?$(this).removeClass("empty"):$(this).addClass("empty")})}),$("#tag-box").on("click","a",function(){$(this).toggleClass("active")}),$("#desc").on("input",function(){$("#desc-status").text($("#desc").val().length+"/150")}),$("#btn-confirm").on("click",function(){if(s<1)showAlert("请先评分");else{var n=[];$("#tag-box a.active").each(function(){n.push($(this).text())}),function(t){if(e)return;showLoad(),e=!0,goAPI({url:_api.submit_score,data:t,success:function(t){showConfirm({str:"您的评价已经提交成功，感谢您对车V互助的支持！车V互助因您而更加强大",class:"shadow-blue",cover_background:"rgba(255,255,255,0.5)",btn_yes:{str:null}}),setTimeout(function(){window.history.go(-1)},2e3)},error:function(t){showConfirm({str:t})},complete:function(){hideLoad(),e=!1}})}({token:o.token,eventNo:t.eventNo,score:s,content:$("#desc").val().trim(),labelContent:n.join("_")})}}),_config.is_wx&&!_config.wx_config&&configWXJSSDK(_config.wx_share,{success:function(){shareWX({title:_share_title,desc:_share_desc,link:_share_link})}})):showConfirm({str:"该订单无法进行评价",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}})},error:function(t){showConfirm({str:t,btn_yes:{str:"重新加载",event_click:i}})},complete:function(){hideLoad()}})}():showConfirm({str:"缺少订单ID",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}}))}();