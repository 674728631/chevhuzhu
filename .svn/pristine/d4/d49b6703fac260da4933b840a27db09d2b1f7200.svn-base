"use strict";!function(){var e,t=checkLogin(),o=juicer($("#main-tpl").html()),s=0,n=getUrlPar("fromid"),i=getUrlPar("sid"),a={};n&&saveStorage("from_id",n,!0);function r(){showLoad(),goAPI({url:_api.index,data:{token:t?t.token:""},success:function(t){t=t.data;var i={};if($.isArray(t.carList)&&t.carList.length>0){var c=t.carList;if(1===c.length)1==c[0].status?(a&&a.name?(i.type="qudao",i.shop=a):i.type="normal",i.href="/hfive/view/car_add_pay.html?id="+c[0].id):(i.type="share",i.href="/hfive/view/share.html");else{for(var l=!0,h=0,f=c.length;h<f;h++)if(c[h].status>=13){l=!1;break}l?(i.type="normal",i.href="/hfive/view/car.html?type=2"):(i.type="share",i.href="/hfive/view/share.html")}}else a&&a.name?(i.type="qudao",i.shop=a):i.type="normal",i.href="/hfive/view/car_add.html?from=index";t.btn_join=i,$(".container").html(o.render(t)),s=$("#showbox").offset().top,$(".intro-list2").on("click",".intro-btn",function(){$(this).closest(".intro-item").toggleClass("active")}),$(".show-menu").on("click","a",function(){var t=$(this).index();$(".show-menu").each(function(e,o){$(o).find("a").removeClass("active").eq(t).addClass("active")}),$("#show-content .show-item").eq(t).removeClass("hide").siblings(".show-item").addClass("hide"),setTimeout(function(){e.scrollTo(0,s)},50),$(".navbar-bottom").addClass("close"),$(".btn-join.join-top").removeClass("active"),$(".btn-join.join-bottom").addClass("active")}),$("#show-content").on("swipeLeft",function(){var e=$(".show-menu.show-top a.active").index();e<2&&$(".show-menu.show-top a").eq(e+1).click()}).on("swipeRight",function(){var e=$(".show-menu.show-top a.active").index();e>0&&$(".show-menu.show-top a").eq(e-1).click()}),e=tabbox({container:".tabbox",height:"100%",pull:!0,exception_class:".no-scroll",event_pullMove:function(e,t){e>=40?($(".tabbox-refresh .txt").text("松开刷新"),$(".tabbox-refresh .arr3").addClass("uturn")):($(".tabbox-refresh .txt").text("下拉刷新"),$(".tabbox-refresh .arr3").removeClass("uturn"))},event_pullEnd:function(e,t){e>=40&&($(".tabbox-refresh .txt").text("下拉刷新"),$(".tabbox-refresh .arr3").removeClass("uturn"),r())},event_scroll:function(e,t,o){t>=s?($(".show-menu.show-main").addClass("close"),$(".show-menu.show-top").removeClass("close")):($(".show-menu.show-main").removeClass("close"),$(".show-menu.show-top").addClass("close")),-1===o?($(".navbar-bottom").addClass("close"),$(".btn-join.join-top").removeClass("active"),$(".btn-join.join-bottom").addClass("active")):1===o&&t<s&&($(".navbar-bottom").removeClass("close"),$(".btn-join.join-top").addClass("active"),$(".btn-join.join-bottom").removeClass("active"))}}),function(){var e=$("#scroll-panel"),t=e.closest(".intro-fbox").siblings(".intro-desc"),o=(e.find(".intro-item").length,!1),s=4,n=0,i=0;function a(o){(i=o-n)<0||i>s-1?i<0?i=0:i>s-1&&(i=s-1):(t.removeClass("s1 s2 s3 s4").addClass("s"+(i+1)).find("p").removeClass("show").filter(".p"+(n+i+1)).addClass("show"),e.find(".intro-item").removeClass("active").eq(n+i).addClass("active"))}$("#scroll-box").on("swipeLeft",function(){a(i+1)}).on("swipeRight",function(){a(i-1)}),e.on("click",".intro-item",function(){var e=$(this);e.hasClass("active")||o||a(e.index())})}(),_config.is_wx&&(_config.wx_config||configWXJSSDK(_config.wx_share,{success:function(){shareWX({title:_share_title,desc:_share_desc,link:_share_link})}}),checkFollow({success:function(e){1==e.data?$(".btn-join2").off("click"):($(".btn-join2").off("click").on("click",function(e){e.preventDefault(),showConfirm({str:"扫码认识我",cover_close:!0,node:'<img src="/hfive/img/chevhuzhu_qr_s.jpg" style="width:3rem;height:3rem;">',btn_close:!0,btn_yes:{str:null}})}),n&&showConfirm({str:"关注公众号<br>我们一起领取500元额度",cover_close:!0,node:'<img src="/hfive/img/chevhuzhu_qr_s.jpg" style="width:3rem;height:3rem;">',btn_close:!0,btn_yes:{str:null}}))}}))},error:function(e){showConfirm({str:e,btn_yes:{str:"重新加载",event_click:r}})},complete:function(){hideLoad()}})}function c(e){i?goAPI({url:_api.shop_detail_simple,data:{shopId:i},success:function(t){(t=t.data)&&(a=t),$.isFunction(e)&&e()},error:function(t){$.isFunction(e)&&e()}}):$.isFunction(e)&&e()}juicer.register("build_btime",function(){var e=new Date("2018","3","4"),t=(new Date).getTime()-e.getTime();return t<=0?"1":Math.ceil(t/864e5)}),_config.is_wx?wxOauth(function(){c(r)}):c(r)}();