"use strict";!function(){var t=!1,e=checkLogin(!0),n=juicer($("#list-tpl").html()),o=!1,a=1,i={},l=null,s=!1,r=Date.now();e&&c(!0);tabbox({container:".tabbox",height:"100%",pull:!0,event_pullMove:function(t,e){t>=40?($(".tabbox-refresh").eq(e).find(".txt").text("松开刷新"),$(".tabbox-refresh").eq(e).find(".arr3").addClass("uturn")):($(".tabbox-refresh").eq(e).find(".txt").text("下拉刷新"),$(".tabbox-refresh").eq(e).find(".arr3").removeClass("uturn"))},event_pullEnd:function(t,e){t>=40&&($(".tabbox-refresh").eq(e).find(".txt").text("下拉刷新"),$(".tabbox-refresh").eq(e).find(".arr3").removeClass("uturn"),c(!0))},event_scrollBottom:function(e,n){t||o||c()}});function d(t){s||(s=!0,goAPI({url:_api.car_list,data:{status:20,flag:1,token:e.token,pageSize:100},success:t,error:function(t){showConfirm({str:t,btn_yes:{str:"重新加载",event_click:d}})},complete:function(){s=!1}}))}function c(l){t||(showLoad(),t=!0,l&&(a=1,o=!1),goAPI({url:_api.order_list,data:{token:e.token,pageNo:a},success:function(t){if(t=t.data,l&&($("#list-area").empty(),i={}),0==t.total)o=!0,$(".tabbox-tab").addClass("full"),$(".null-info").removeClass("hide");else{a+=1;for(var e=t.list,s=0,r=e.length;s<r;s++)i[e[s].eventNo]=e[s];t.lipei_max=_config.lipei_max,$(".tabbox-tab").removeClass("full"),$(".null-info").addClass("hide"),$("#list-area").append(n.render(t)),t.hasNextPage||(o=!0)}},error:function(t){l?showConfirm({str:t,btn_yes:{str:"重新加载",event_click:function(){c(l)}}}):showConfirm({str:t})},complete:function(){hideLoad(),t=!1}}))}$("#btn-add").on("click",function(){var t;(Date.now()-r>6e5&&(l=null),l)?(t=0==l.list.length?'<div id="add-list"><div class="loading-box default"><p class="loading-text">正在获取可申请救助的车辆</p><p class="default-text">暂无可申请救助的车辆 <a class="hover txt-blue" href="/hfive/view/car_add.html">立即加入互助</a></p></div></div>':'<div id="add-list">'+juicer($("#add-tpl").html(),l)+"</div>",showConfirm({title:"选择救助车辆",class:"add-list shadow-blue",full:!0,btn_close:!0,cover_background:"rgba(255,255,255,0.5)",node:t,btn_yes:{event_click:function(){var t=$("#add-list .item.active");t.length>0&&(window.location.href="/hfive/view/order_add.html?id="+t.eq(0).data("value"))}},btn_cancel:{str:"取消"}})):(showConfirm({title:"选择救助车辆",class:"add-list shadow-blue",full:!0,btn_close:!0,cover_background:"rgba(255,255,255,0.5)",node:'<div id="add-list"><div class="loading-box loading"><p class="loading-text">正在获取可申请救助的车辆</p><p class="default-text">暂无可申请救助的车辆 <a class="hover txt-blue" href="/hfive/view/car_add.html">立即加入互助</a></p></div></div>',btn_yes:{event_click:function(){var t=$("#add-list .item.active");t.length>0&&(window.location.href="/hfive/view/order_add.html?id="+t.eq(0).data("value"))}},btn_cancel:{str:"取消"}}),d(function(t){r=Date.now(),0==(l=t.data).total?$("#add-list .loading-box").removeClass("hide loading").addClass("default"):(l.list=$.map(l.list,function(t,e){return t.orderNo&&100!=t.statusOrder&&10!=t.orderIsInvalid||t.eventNo&&100!=t.statusEvent&&10!=t.eventIsInvalid?null:t}),0===l.list.length?$("#add-list .loading-box").removeClass("hide loading").addClass("default"):($("#add-list .loading-box").addClass("hide"),$("#add-list").html(juicer($("#add-tpl").html(),l))))}));$(".add-list").off("click").on("click",".item",function(){$(this).addClass("active").siblings().removeClass("active")})}),$("#list-area").on("click",".btn",function(){var o=$(this);if(o.hasClass("btn-confirm")){if(!(a=i[o.data("value")]))return void showConfirm({str:"未找到该订单的信息，无法完成操作"});showConfirm({title:"亲，您确定维修中心已经交车给您了？",str:"维修中心交车给您前，请您认真核实汽车维修得是否满意",color:"#4895e5",cover_close:!0,btn_yes:{str:"确定",event_click:function(){var o,i;o={token:e.token,eventNo:a.eventNo},i=function(){a.statusEvent=71;var t=$(".item.o"+a.eventNo);if(t.length>0){var e=$(n.render({list:[a]}));t.html(e.html()),e=null}},t||(showLoad(),t=!0,goAPI({url:_api.order_confirm,data:o,success:function(t){showConfirm({str:"操作成功",btn_yes:{event_click:i}})},error:function(t){showConfirm({str:t})},complete:function(){hideLoad(),t=!1}}))}},btn_cancel:{str:"取消"}})}else if(o.hasClass("btn-resolve")){var a;if(!(a=i[o.data("value")]))return void showConfirm({str:"未找到该订单的信息，无法完成操作"});showConfirm({title:"您确定投诉问题已经解决\n并且确认已经接到您的爱车了？",cover_close:!0,btn_yes:{str:"确定",event_click:function(){var o,i;o={token:e.token,eventNo:a.eventNo},i=function(){a.statusEvent=71;var t=$(".item.o"+a.eventNo);if(t.length>0){var e=$(n.render({list:[a]}));t.html(e.html()),e=null}},t||(showLoad(),t=!0,goAPI({url:_api.order_report,data:o,success:function(t){showConfirm({str:"操作成功",btn_yes:{event_click:i}})},error:function(t){showAlert(t)},complete:function(){hideLoad(),t=!1}}))}},btn_cancel:{str:"取消"}})}})}();