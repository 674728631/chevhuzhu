"use strict";!function(){var t=getUrlPar("id"),e=getUrlPar("oid"),o=!1,n=checkLogin(!0),i="";function s(s){if(_config.is_wx&&!_config.wx_config&&configWXJSSDK(["chooseImage","uploadImage"].concat(_config.wx_share),{success:function(){}}),s.statusEvent&&2!=s.statusEvent)showConfirm({str:"只有未通过审核的救助申请才可以进行修改",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}});else{if(t||(t=s.carId),i=s.licensePlateNumber,$(".container").html(juicer($("#main-tpl").html(),s)),$("#desc-status").text($("#desc").val().length+"/200"),s.accidentImg)for(var r,c=0,a=(r=$.isArray(s.accidentImg)?s.accidentImg:s.accidentImg.split("_")).length;c<a&&!(c>3);c++)$("#photo"+(c+1)).removeClass("default").html('<img src="'+r[c]+'" onload="resetImg(this, \'fix\')">');$(".btn-upload2").on("click",function(){if(_config.is_wx_mobile)if(_config.wx_config){var t=$(this);wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(e){var o=e.localIds;wxUploadPhoto({localId:o[0],success:function(e){var n=e.serverId;t.removeClass("default").html('<img src="'+o[0]+'" onload="resetImg(this, \'fix\')" data-value="'+n+'">')}})}})}else showAlert("正在调用摄像头...请稍后再点击");else showAlert("请在手机微信客户端中上传照片")}),$("#btn-confirm").on("click",function(){var s=$("#desc").val().trim(),r=[];if(0!==s.length){var c,a=$("#photo1 img").eq(0),l=$("#photo2 img").eq(0),d=$("#photo3 img").eq(0),h=$("#photo4 img").eq(0);if(0!==a.length)if(0!==l.length)if(0!==d.length&&0!==h.length)$([a,l,d,h]).each(function(t,e){var o=$(e),n=o.attr("src");/^http/.test(n)?r.push(n.match(/.+\/(.+\.jpe?g|.+\.png)/)[1]):r.push(o.data("value"))}),c={token:n.token,eventNo:e,carId:t,description:s,base:r},o||(showLoad(),o=!0,goAPI({url:_api.add_order,data:c,traditional:!0,success:function(o){window.location.href="/hfive/view/order_add2.html?id="+t+"&oid="+(o.data?o.data:e)},error:function(e,o,n){488==o?showConfirm({str:i+"的车辆已经有一个订单，请不要重复申请，谢谢。",btn_yes:{str:"查看订单",href:"/hfive/view/order_detail.html?id="+n.data},btn_no:{str:"我知道了"}}):2e3==o?showConfirm({str:e,btn_yes:{str:"发起保险理赔",href:"/hfive/view/baoxian_order_add.html?id="+t},btn_no:{str:"我知道了"}}):showConfirm({class:"fail",full:!0,title:"您的"+i+"车辆信息提交失败！\n请重新提交",str:"失败原因："+e,btn_yes:{str:"我知道了"}})},complete:function(){hideLoad(),o=!1}}));else showAlert("请上传两张受损处细节照片");else showAlert("请上传含被撞物体受损的照片");else showAlert("请上传45°角带车牌拍摄整车的照片")}else showAlert("请描述事故信息")}),$("#desc").on("input",function(){$("#desc-status").text($("#desc").val().length+"/200")})}}n&&(t||e?e?function t(e,n){o||(showLoad(),o=!0,goAPI({url:_api.order_detail,data:e,success:function(t){$.isFunction(n)&&n(t.data)},error:function(o){showConfirm({str:o,btn_yes:{str:"重新加载",event_click:function(){t(e,n)}}})},complete:function(){hideLoad(),o=!1}}))}({token:n.token,eventNo:e},s):function t(e,n){o||(showLoad(),o=!0,goAPI({url:_api.car_detail,data:e,success:function(t){$.isFunction(n)&&n(t.data)},error:function(o){showConfirm({str:o,btn_yes:{str:"重新加载",event_click:function(){t(e,n)}}})},complete:function(){hideLoad(),o=!1}}))}({token:n.token,id:t},s):showConfirm({str:"缺少车辆ID",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}}))}();