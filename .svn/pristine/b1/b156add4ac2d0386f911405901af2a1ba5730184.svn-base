"use strict";!function(){var t=!1,e=checkLogin(!0),o=juicer($("#list-tpl").html()),a=!1,n=1,i={},s=null,r=!1,l=Date.now();e&&f(!0);tabbox({container:".tabbox",height:"100%",pull:!0,wheel_self:!1,event_pullMove:function(t,e){t>=40?($(".tabbox-refresh").eq(e).find(".txt").text("松开刷新"),$(".tabbox-refresh").eq(e).find(".arr3").addClass("uturn")):($(".tabbox-refresh").eq(e).find(".txt").text("下拉刷新"),$(".tabbox-refresh").eq(e).find(".arr3").removeClass("uturn"))},event_pullEnd:function(t,e){t>=40&&($(".tabbox-refresh").eq(e).find(".txt").text("下拉刷新"),$(".tabbox-refresh").eq(e).find(".arr3").removeClass("uturn"),f(!0))},event_scrollBottom:function(e,o){t||a||f()}});function d(e,o){var a,n;t||(_config.is_wx_mobile?_config.wx_config&&(a=e,n=o,t||(showLoad(),t=!0,goAPI({url:_api.baoxian_order_pay,data:a,traditional:!0,success:function(t){wx.chooseWXPay({appId:t.data.appId,timestamp:t.data.timeStamp.toString(),nonceStr:t.data.nonceStr,package:t.data.package,signType:t.data.signType,paySign:t.data.paySign,success:function(t){showConfirm({str:"支付成功",btn_yes:{event_click:n}})}})},error:function(t){showConfirm({str:t})},complete:function(){hideLoad(),t=!1}}))):showConfirm({str:"请使用微信移动客户端打开该页面再进行支付"}))}function c(t){r||(r=!0,goAPI({url:_api.car_list,data:{status:"13,20",flag:1,token:e.token,pageSize:100},success:t,error:function(t){showConfirm({str:t,btn_yes:{str:"重新加载",event_click:c}})},complete:function(){r=!1}}))}function f(s){t||(showLoad(),t=!0,s&&(n=1,a=!1),goAPI({url:_api.baoxian_order_list,data:{token:e.token,pageNo:n},success:function(t){if(t=t.data,s&&($("#list-area").empty(),i={}),0==t.total)a=!0,$(".tabbox-tab").addClass("full"),$(".null-info").removeClass("hide");else{n+=1;for(var e=t.list,r=0,l=e.length;r<l;r++)i[e[r].orderNo]=e[r];t.lipei_max=_config.lipei_max,$(".tabbox-tab").removeClass("full"),$(".null-info").addClass("hide"),$("#list-area").append(o.render(t)),t.hasNextPage||(a=!0)}_config.is_wx_mobile&&!_config.wx_config&&configWXJSSDK(["previewImage","chooseWXPay"].concat(_config.wx_share),{success:function(){}})},error:function(t){s?showConfirm({str:t,btn_yes:{str:"重新加载",event_click:function(){f(s)}}}):showConfirm({str:t})},complete:function(){hideLoad(),t=!1}}))}$("#btn-add").on("click",function(){var t;(Date.now()-l>6e5&&(s=null),s)?(t=0==s.list.length?'<div id="add-list"><div class="loading-box default"><p class="loading-text">正在获取可申请理赔的车辆</p><p class="default-text">暂无可申请理赔的车辆 <a class="hover txt-blue" href="/hfive/view/car_add.html">立即加入互助</a></p></div></div>':'<div id="add-list">'+juicer($("#add-tpl").html(),s)+"</div>",showConfirm({title:"选择理赔车辆",class:"add-list shadow-blue",full:!0,btn_close:!0,cover_background:"rgba(255,255,255,0.5)",node:t,btn_yes:{event_click:function(){var t=$("#add-list .item.active");t.length>0&&(window.location.href="/hfive/view/baoxian_order_add.html?id="+t.eq(0).data("value"))}},btn_cancel:{str:"取消"}})):(showConfirm({title:"选择理赔车辆",class:"add-list shadow-blue",full:!0,btn_close:!0,cover_background:"rgba(255,255,255,0.5)",node:'<div id="add-list"><div class="loading-box loading"><p class="loading-text">正在获取可申请理赔的车辆</p><p class="default-text">暂无可申请理赔的车辆 <a class="hover txt-blue" href="/hfive/view/car_add.html">立即加入互助</a></p></div></div>',btn_yes:{event_click:function(){var t=$("#add-list .item.active");t.length>0&&(window.location.href="/hfive/view/baoxian_order_add.html?id="+t.eq(0).data("value"))}},btn_cancel:{str:"取消"}}),c(function(t){l=Date.now(),0==(s=t.data).total?$("#add-list .loading-box").removeClass("hide loading").addClass("default"):(s.list=$.map(s.list,function(t,e){return t.orderNo&&100!=t.statusOrder&&10!=t.orderIsInvalid||t.eventNo&&100!=t.statusEvent&&10!=t.eventIsInvalid?null:t}),0===s.list.length?$("#add-list .loading-box").removeClass("hide loading").addClass("default"):($("#add-list .loading-box").addClass("hide"),$("#add-list").html(juicer($("#add-tpl").html(),s))))}));$(".add-list").off("click").on("click",".item",function(){$(this).addClass("active").siblings().removeClass("active")})}),$("#list-area").on("click",".btn",function(){var a=$(this);if(a.hasClass("btn-confirm")){if(!(n=i[a.data("value")]))return void showConfirm({str:"未找到该订单的信息，无法完成操作"});showConfirm({title:"亲，您确定维修中心已接车？",str:"维修中心人员来接车，请先核对下其身份",color:"#4895e5",cover_close:!0,btn_yes:{str:"确定",event_click:function(){var a,i;a={token:e.token,orderNo:n.orderNo},i=function(){n.status=31;var t=$(".item.o"+n.orderNo);if(t.length>0){var e=$(o.render({list:[n]}));t.html(e.html()),e=null}},t||(showLoad(),t=!0,goAPI({url:_api.baoxian_order_confirm,data:a,success:function(t){showConfirm({str:"操作成功",btn_yes:{event_click:i}})},error:function(t){showConfirm({str:t})},complete:function(){hideLoad(),t=!1}}))}},btn_cancel:{str:"取消"}})}else if(a.hasClass("btn-pay")){if(!(n=i[a.data("value")]))return void showConfirm({str:"未找到该订单的信息，无法完成操作"});d({token:e.token,orderNo:n.orderNo},function(){n.status=61;var t=$(".item.o"+n.orderNo);if(t.length>0){var e=$(o.render({list:[n]}));t.html(e.html()),e=null}})}else if(a.hasClass("btn-resolve")){var n;if(!(n=i[a.data("value")]))return void showConfirm({str:"未找到该订单的信息，无法完成操作"});showConfirm({title:"您确定投诉问题已经解决\n并且确认已经接到您的爱车了？",cover_close:!0,btn_yes:{str:"确定",event_click:function(){var a,i;a={token:e.token,orderNo:n.orderNo},i=function(){t=!1,d({token:e.token,orderNo:n.orderNo},function(){n.status=61;var t=$(".item.o"+n.orderNo);if(t.length>0){var e=$(o.render({list:[n]}));t.html(e.html()),e=null}})},t||(showLoad(),t=!0,goAPI({url:_api.baoxian_order_report,data:a,success:function(t){showConfirm({str:"操作成功",btn_yes:{event_click:i}})},error:function(t){showAlert(t)},complete:function(){hideLoad(),t=!1}}))}},btn_cancel:{str:"取消"}})}})}();