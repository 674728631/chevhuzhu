"use strict";!function(){var t=getUrlPar("id"),e=getUrlPar("oid"),o=!1,i=checkLogin(!0),n="";function s(s){if(_config.is_wx&&!_config.wx_config&&configWXJSSDK(["chooseImage","uploadImage"].concat(_config.wx_share),{success:function(){}}),s.statusOrder&&2!=s.statusOrder)showConfirm({str:"只有未通过审核的理赔申请才可以进行修改",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}});else{if(t||(t=s.carId),n=s.licensePlateNumber,$(".container").html(juicer($("#main-tpl").html(),$.extend(s,{cid:t,oid:e}))),$("#desc-status").text($("#desc").val().length+"/200"),s.accidentImg)for(var r,a=0,c=(r=$.isArray(s.accidentImg)?s.accidentImg:s.accidentImg.split("_")).length;a<c&&!(a>2);a++)$("#photo"+(a+1)).removeClass("default").html('<img src="'+r[a]+'" onload="resetImg(this, \'fix\')">');$(".btn-upload2").on("click",function(){if(_config.is_wx_mobile)if(_config.wx_config){var t=$(this);wx.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var o=e.localIds;wxUploadPhoto({localId:o[0],success:function(e){var i=e.serverId;t.removeClass("default").html('<img src="'+o[0]+'" onload="resetImg(this, \'fix\')" data-value="'+i+'">')}})}})}else showAlert("正在调用摄像头...请稍后");else showAlert("请在手机微信客户端中上传照片")}),$("#btn-confirm").on("click",function(){var s=$("#desc").val().trim(),r=[];if(0!==s.length){var a,c=$("#photo1 img").eq(0),l=$("#photo2 img").eq(0),d=$("#photo3 img").eq(0);if(0!==c.length)if(0!==l.length)if(0!==d.length)$([c,l,d]).each(function(t,e){var o=$(e),i=o.attr("src");/^http/.test(i)?r.push(i.match(/.+\/(.+\.jpe?g|.+\.png)/)[1]):r.push(o.data("value"))}),a={token:i.token,orderNo:e,carId:t,description:s,base:r},o||(showLoad(),o=!0,goAPI({url:_api.add_baoxian_order,data:a,traditional:!0,success:function(o){window.location.href="/hfive/view/baoxian_order_add2.html?id="+t+"&oid="+(o.data?o.data:e)},error:function(t,e,o){488==e?showConfirm({str:n+"的车辆已经有个理赔订单，请不要重复申请，谢谢。",btn_yes:{str:"查看订单",href:"/hfive/view/baoxian_order_detail.html?id="+o.data},btn_no:{str:"我知道了"}}):showConfirm({class:"fail",full:!0,title:"您的"+n+"车辆信息提交失败！\n请重新提交",str:"失败原因："+t,btn_yes:{str:"我知道了"}})},complete:function(){hideLoad(),o=!1}}));else showAlert("请上传受损处细节的照片");else showAlert("请上传含被撞物体受损的照片");else showAlert("请上传45°角带车牌拍摄整车的照片")}else showAlert("请描述事故信息")}),$("#desc").on("input",function(){$("#desc-status").text($("#desc").val().length+"/200")})}}i&&(t||e?e?function t(e,i){o||(showLoad(),o=!0,goAPI({url:_api.baoxian_order_detail,data:e,success:function(t){$.isFunction(i)&&i(t.data)},error:function(o){showConfirm({str:o,btn_yes:{str:"重新加载",event_click:function(){t(e,i)}}})},complete:function(){hideLoad(),o=!1}}))}({token:i.token,orderNo:e},s):function t(e,i){o||(showLoad(),o=!0,goAPI({url:_api.car_detail,data:e,success:function(t){$.isFunction(i)&&i(t.data)},error:function(o){showConfirm({str:o,btn_yes:{str:"重新加载",event_click:function(){t(e,i)}}})},complete:function(){hideLoad(),o=!1}}))}({token:i.token,id:t},s):showConfirm({str:"缺少车辆ID",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}}))}();