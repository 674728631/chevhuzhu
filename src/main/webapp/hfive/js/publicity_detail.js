"use strict";!function(){var t,e,n,i=checkLogin(),o=getUrlPar("id"),c=preview({fixed:!0,background:"#000000",number:!0,point:!0,fill:"fix"});function s(){showLoad(),goAPI({url:_api.publicity_detail,data:{eventNo:o},success:function(n){var o;t=n.data,i?(o=function(t){e=t.list,r()},goAPI({url:_api.car_list,data:{token:i.token,pageSize:1e3},success:function(t){$.isFunction(o)&&o(t.data)},error:function(t){showConfirm({str:t,btn_yes:{str:"重新加载",event_click:s}})},complete:function(){hideLoad()}})):r()},error:function(t){showConfirm({str:t,btn_yes:{str:"重新加载",event_click:s}})},complete:function(){hideLoad()}})}function r(){if(t.commentLabelContent?t.commentLabelContent=t.commentLabelContent.split("_"):t.commentLabelContent=null,"string"===$.type(t.accidentImg)?t.accidentImg=t.accidentImg.split("_"):t.accidentImg||(t.accidentImg=[]),"string"===$.type(t.assertImg)?t.assertImg=t.assertImg.split("_"):t.assertImg||(t.assertImg=[]),"string"===$.type(t.repairImg)?t.repairImg=t.repairImg.split("_"):t.repairImg||(t.repairImg=[]),"string"===$.type(t.carPhotos)?t.carPhotos=t.carPhotos.split("_"):t.carPhotos||(t.carPhotos=[]),$.isArray(e)&&e.length>0)if(n={num:e.length},1===e.length)n.car=e[0];else{for(var i=!1,o=0,s=e.length;o<s;o++)if(20==e[o].status){i=!0;break}n.all_clear=i}else n={num:0};t.btn_join=n,$(".container").html(juicer($("#main-tpl").html(),t)),$(".photo-box").on("click",".photo-item",function(){var t=$(this),e=t.index(),n=[];t.closest(".photo-box").find(".photo-img img").each(function(){n.push($(this).attr("src"))}),_config.is_wx?_config.wx_config&&wx.previewImage({current:n[e],urls:n}):c.show({imgs:n,index:e+1})}),tabbox({container:".tabbox",height:"100%",pull:!1,wheel_self:!1,event_scroll:function(t,e,n){-1===n?$("#btn-join").removeClass("close"):1===n&&$("#btn-join").addClass("close")}}),_config.is_wx&&(_config.wx_config||configWXJSSDK(["previewImage"].concat(_config.wx_share),{success:function(){}}),checkFollow({success:function(t){1==t.data?$(".btn-join").off("click"):$(".btn-join").off("click").on("click",function(t){t.preventDefault(),showConfirm({str:"扫码认识我",cover_close:!0,node:'<img src="/hfive/img/chevhuzhu_qr_s.jpg" style="width:3rem;height:3rem;">',btn_close:!0,btn_yes:{str:null}})})}}))}o?s():showConfirm({str:"缺少事件ID",btn_yes:{str:"返回上一页",href:"javascript:history.go(-1);"},btn_no:{str:"回到首页",href:"/hfive/view/index.html"}})}();