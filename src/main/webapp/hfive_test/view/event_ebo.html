<html>
<head>
  <title>恭喜您</title>
  <meta charset="UTF-8">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=320,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="stylesheet" href="/hfive/css/base.css?v=9">
<script type="application/javascript" src="/hfive/lib/fastclick.js"></script>
<script>
  
  if ('addEventListener' in document) {
    document.addEventListener('DOMContentLoaded', function() {
      FastClick.attach(document.body);
    }, false);
    window.addEventListener('resize', function(){
      var deviceWidth = document.documentElement.clientWidth;
      if(deviceWidth > 750) deviceWidth = 750;
      document.documentElement.style.fontSize = deviceWidth / 7.5 + 'px';
    });
  }
  var deviceWidth = document.documentElement.clientWidth;
  if(deviceWidth > 750) deviceWidth = 750;
  document.documentElement.style.fontSize = deviceWidth / 7.5 + 'px';
</script>
  <style>
    .container {
      background-color: #ee474e;
      padding-bottom: .6rem;
    }
    input {
      display: block;
      margin: .2rem auto 0;
      width: 5.4rem;
      height: 50px;
      border-radius: 30px;
      background-color: #d3333a;
      text-align: center;
      color: #fff;
    }
    ::-webkit-input-placeholder {
      color: #fff;
    }
    #code {
      margin-top: 1rem;
    }
    #btn-confirm,
    #btn-confirm2 {
      width: 5.4rem;
      margin: .3rem auto 0;
      height: 50px;
      border-radius: 30px;
      color: #ac4600;
      box-shadow: 0 3px 5px #920a07;
      background: #fff36d;
      background: linear-gradient(to bottom, #fff36d 0%, #fff36d 46%, #ffd409 52%, #ffd409 100%);
    }
    #btn-box {
      position: relative;
    }
    .coin {
      position: absolute;
      width: .6rem;
      height: .4rem;
      top: 100%;
      left: .6rem;
      margin-top: .05rem;
      background: url(data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAA8AAD/7gAOQWRvYmUAZMAAAAAB/9sAhAAGBAQEBQQGBQUGCQYFBgkLCAYGCAsMCgoLCgoMEAwMDAwMDBAMDg8QDw4MExMUFBMTHBsbGxwfHx8fHx8fHx8fAQcHBw0MDRgQEBgaFREVGh8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx//wAARCAAoADoDAREAAhEBAxEB/8QAmgAAAgIDAQAAAAAAAAAAAAAABQYEBwECAwABAAIDAQEBAAAAAAAAAAAAAAQFAgMGAQAHEAABAgQDBQYDBwUAAAAAAAABAgMAEQQFITESQVFhEwbwcSJCFAeBoTKR8VJicoIVkiNTJBcRAAEDAgQBCwIHAQAAAAAAAAEAAgMRBCExEgVBUWFxgaHRIjJCUhPwsZHBkjMUJBUG/9oADAMBAAIRAxEAPwDnT079S+hhhCnXnCEttpEySdgAhBJI1jS5xoAvrkkjWNLnGgCfLP7ZIWD/ACLyitJAcSyQEN/lKzPUrgn7kbN2fK6rAGxA4udx6As5cb470Cg58yi9X7ZdPts/2HtbhOE9REuMiMYt3LcGMYDG+rkGzeJ3HEUQuo9s2ZTZWkkYyStST8NesdtsJGb9MM/siGbw4Z1S5cui7lRqIGexLg0z/SsTSYa2+/sd5xToxTKHdmuzQJ+nfp3C2+2ptweVQl9m+HkUzJBqaahM45mvFQVpFitXo8vK0va/p5lukVcVgKrHmytsHNLQUE4cVYz4RmNye65dLG3KJlek1FfwCyO+XhLtPpBp1pxZbAt1IEzkW5qn/kJPMnx1R0xtMEWny6O3j2pOTR7uns4JUvHUdxavf8TQ0zRd1BAXUqKEqUU6p7ABLtlC51s3VQoprBo1E4KPT9cUzdSqkvLPo6hMiXGlB5lWE8FJnnsiqSy9uK9owqEMe60u9vqHF17ZuVgqj/rvlnkyJTMJAX4VCUiDuOcWv25rm+DwvGfFRDR0FMV46RYqKMLSzzWiCpylP1pB8zKjiCB5eEdtraaNofGaS8nA8yshvSx2B6+9VpfbE9a3UqCubSPYsP796VSyIjRbbuTblpB8MjcwtXZXglFDg4IXDRHq0OhOoENUVI8MTSp9PUolKaZ5/wBMZGeR1nffIRVrs+dpzWT3Kzq57eU1CfHENMp5zZ5luqDzEupx5ajmZDynbB7o222Fa2zzVjvYTwPMs+1xJofOO1L3UfR9DdQt0K5VWsJ0vzKkKCQEgHdhFM9vxOfKiobksw4dq426wOC1qoryzS1CVSADTYQdIE/ERmdW0QI4luSk5wrVpKjD2usVRL1DlUaPy0ZdJRI/UMcQDBls1x8ThRQfORgE46dEtHh0y0y2Syi0g1Q6UerLRTuu3GgSkct1pqrZQJ+BxwL+n9yPmYW7qf418yZuHyAE9efemW3zubpdxBoqhkeGcs42GpbfWERsd5ctj6jLUy4JOI7siIX7jYC4ZTJwyQ13bfI3DzBOdl69etLidA9XbHyOZTeYapDw7lY5QrsZJIKxPFWH09yyt9Yh2fheOKsSkNHWpUq0vpSrBT1G4NQQVCfiRPUnPMQwftr2H+uaxn0OxA/MdSSmQjzjr+s1havTuH1NMsEbWiHE98sFS+ExC+SaKJ5EzXNd+od6uB1DAj7LKrvbcZulB3KQoEbd26L/APRt3esLggfyKO9fKFKTyUOVLnlQlJQmfFasAO20RRJuNs0VLtXMFMQPPIErX+9+jpqu41RSaupkG0pwSClJS22iexAOMJD8u43YJwHJ7WhNLO01kMbkPqqqjWr5z+Mb7SFsdAWIkpLoxUPU7qXWlaVoIUnvERLATUhUywNkFHBHemesKqxVVwuKEc+51qNPNWSQAMRhE4joqeJSe72RslADQBaI90vcFt9TjrtNWNqIPJeaEhL8KklJl2wgW4t2zfuAOQjtgAHhU3/r1+WAHLOykzxLby5Y942dscYTS7BG41aS3tUW7K4HNcnvci+PpIRSMU5OSlKU8R3A6R27443/AJ5nqcac2CMh2anmKBV9yrq97nVjynXAJJnkBuAGAh1a2kcDdMYoE5hgZGKNFFGglXL/2Q==) center/100% auto no-repeat;
    }
    .coin.c2 {
      width: .3rem;
      height: .2rem;
      margin-top: .3rem;
      left: 1.4rem;
    }
    #result {
      background-color: #ee474e;
    }
  </style>
</head>
<body>
  <div id="container1" class="container full">
    <img src="/hfive/img/event_ebo_1.jpg?1" width="100%">
    <input id="phone" class="fsize-18 fstrong" type="tel" placeholder="请输入手机号码" maxlength="11">
    <input id="car" class="fsize-18 fstrong" type="text" placeholder="请输入车牌号" maxlength="10">
    <div id="btn-box">
      <a id="btn-confirm" class="fbox-cc fsize-20 fstrong hover" href="javascript:;">下一步</a>
      <i class="coin c1"></i>
      <i class="coin c2"></i>
    </div>
  </div>
  <div id="container2" class="container full hide">
    <img src="/hfive/img/event_ebo_3.jpg" width="100%">
    <input id="code" class="fsize-18 fstrong" type="text" placeholder="请输入消费验证码" maxlength="10">
    <div id="btn-box">
      <a id="btn-confirm2" class="fbox-cc fsize-20 fstrong hover" href="javascript:;">确　定</a>
      <i class="coin c1"></i>
      <i class="coin c2"></i>
    </div>
  </div>
  <div id="result" class="hide">
    <img src="/hfive/img/event_ebo_2.jpg" width="100%">
  </div>
  <script src="/hfive/lib/zepto.js"></script>
<script src="/hfive/lib/juicer.js"></script>
<script src="/hfive/js/common.js?v=41"></script>
<script>
  if (typeof WeixinJSBridge == "object" && typeof WeixinJSBridge.invoke == "function") {
    handleFontSize();
  } else {
    if (document.addEventListener) {
      document.addEventListener("WeixinJSBridgeReady", handleFontSize, false);
    } else if (document.attachEvent) {
      document.attachEvent("WeixinJSBridgeReady", handleFontSize);
      document.attachEvent("onWeixinJSBridgeReady", handleFontSize);
    }
  }

  function handleFontSize() {
    // 设置网页字体为默认大小
    WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
    // 重写设置网页字体大小的事件
    WeixinJSBridge.on('menu:setfont', function() {
      WeixinJSBridge.invoke('setFontSizeCallback', { 'fontSize' : 0 });
    });
  }
</script>
  <script src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
  <script>
    var user_phone;
    var user_car;
    var loading;
    var cid;
    var uid;
  
    if (_config.is_wx) {
      wxOauth(function(){
        $('#btn-confirm').on('click', confirm_data);
        $('#btn-confirm2').on('click', confirm_data2);
      })
    }
    
    function confirm_data() {
      if (loading) {
        return;
      }
      var phone = $('#phone').val().trim();
      var car = $('#car').val().trim();
      if (phone.length < 11) {
        showAlert('请输入手机号码');
        return;
      }
      if (!validatePhone(phone, true)) {
        showAlert('手机号码有误');
        return;
      }
      if (car.length === 0) {
        showAlert('请输入车牌号');
        return;
      }
      if (!validateCar(car)) {
        showAlert('车牌号格式不正确');
        return;
      }
      user_phone = phone;
      user_car = car;
      loading = true;
      showLoad();
      goAPI({
        url: _api.ebo_event,
        data: {
          phoneNo: phone,
          carNo: car
        },
        success: function(data) {
          cid = data.data.carId;
          uid = data.data.customerId;
          $('#container1').addClass('hide');
          $('#container2').removeClass('hide');
        },
        error: function(data) {
          showConfirm({
            str: data
          });
        },
        complete: function() {
          hideLoad();
          loading = false;
        }
      })
    }
    
    function confirm_data2() {
      if (loading) {
        return;
      }
      var code = $('#code').val().trim();
      if (code.length === 0) {
        showAlert('请输入消费验证码');
        return;
      }
      loading = true;
      showLoad();
      goAPI({
        url: _api.ebo_event2,
        data: {
          code: code,
          carId: cid,
          customerId: uid
        },
        success: function(data) {
          $('#container2').addClass('hide');
          $('#result').removeClass('hide');
        },
        error: function(data) {
          showConfirm({
            str: data
          });
        },
        complete: function() {
          hideLoad();
          loading = false;
        }
      })
    }
  </script>
</body>
</html>